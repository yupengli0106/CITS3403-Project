<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>admin_puzzle</title>
	<link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css"/>
	<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="../bootstrap/js/bootstrap.min.js"></script>
	<style type="text/css">
		body{
			
		}
		.header{
			height: 65px;	
		}
		.header .head_top{
			text-align: center;
			width: 100%;
			padding: 10px;
		}
		.header .head_title{
			font-family: initial;
			padding-top: 10px;
			font-size: 40px;
		}
		.header .head_left{
			float: left;
		}
		.header .head_right{
			float: right;
		}
		.header .glyphicon{
			z-index: 6;
		}
		.content{
			height: 600px;
		}
		.content .content_header{
			width: 47%;
			margin: 0 auto;
		}
		.content .search_content{
			width: 82%;
			border: 1px solid black;
		}
		.content .ul_question{
			list-style-type: none;
			width: 50%;
			margin: 0 auto;
			padding: 0px;
			overflow: scroll;
			height: 550px;
		}
		.content .li_question{
			margin: 5px;
   		 	padding: 17px;
		}
		.content .li_right{
			float: right;
		}
		/*.content .btn{
			border: none;

		}*/
		.footer{
			height: 255px;
			padding-top: 10px;
		}
	</style>
</head>
<body>
	<div class="header">
		<div class="head_top">
			<span class="head_title">admin_control</span>
			<span id="head_right" class="head_right">
				<button type="button" class="btn btn-default" aria-label="Left Align" id="logout" > <a href="/logout"> logout </a></button>
			</span>
		</div>
	</div>
	<div class="content">
		<div class="content_header"> 
			<form class="form-horizontal">
				<div class="form-group">
					<!-- <div class="col-sm-10"> -->
						<input type="text" class="btn btn-default search_content" id="search_content" placeholder="search_content">
						<input type="submit" class="btn btn-default" id="submit_search" value="search">
						<button type="button" class="btn btn-default" aria-label="Left Align" data-toggle="modal" data-target="#modal_add_question"> add </button>
					<!-- </div> -->
				</div>
			</form>
		</div>
		<ul class="ul_question" id="ul_question">
			<li class="li_question">
				<div>When was the first industrial revolution in America,When was the first industrial revolution in,When was the first industrial revolution in,When was the first industrial revolution in?
				</div>
				<span class="li_left">
					<span>answer</span>
				</span> 
				<span class="li_right">
					<button  class="btn btn-default">Edit</button> <button  class="btn btn-default">Delete</button>
				</span>
			</li>
			<li class="li_question">
				<div>When was the first industrial revolution in America,When was the first industrial revolution in,When was the first industrial revolution in,When was the first industrial revolution in?
				</div>
				<span class="li_left">
					<button  class="btn btn-default">answer</button>
				</span> 
				<span class="li_right">
					<button  class="btn btn-default">Edit</button> <button class="btn btn-default ">Delete</button>
				</span>
			</li>
			<li class="li_question">
				<div>When was the first industrial revolution in America,When was the first industrial revolution in,When was the first industrial revolution in,When was the first industrial revolution in?
				</div>
				<span class="li_left">
					<button  class="btn btn-default">answer</button>
				</span> 
				<span class="li_right">
					<button  class="btn btn-default">Edit</button> <button  class="btn btn-default">Delete</button>
				</span>
			</li>
			<li class="li_question">
				<div>When was the first industrial revolution in America,When was the first industrial revolution in,When was the first industrial revolution in,When was the first industrial revolution in?
				</div>
				<span class="li_left">
					<button  class="btn btn-default">answer</button>
				</span> 
				<span class="li_right">
					<button  class="btn btn-default">Edit</button> <button  class="btn btn-default">Delete</button>
				</span>
			</li>
			<li class="li_question">
				<div>When was the first industrial revolution in America,When was the first industrial revolution in,When was the first industrial revolution in,When was the first industrial revolution in?
				</div>
				<span class="li_left">
					<button  class="btn btn-default">answer</button>
				</span> 
				<span class="li_right">
					<button  class="btn btn-default">Edit</button> <button  class="btn btn-default">Delete</button>
				</span>
			</li>

		</ul>
	</div>
	<div class="footer">
	</div>
	<div class="modal fade" id="modal_add_question" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Add Question</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
				</div>
				<div class="modal-body">
					<div class="login_box">
						<form class="form-horizontal">
					  		<div class="form-group">
					    		<label for="username" class="col-sm-2 control-label">Question</label>
					    		<div class="col-sm-10">
					    			<textarea class="form-control" id="add_question" placeholder="Question"></textarea>
				    			</div>
				  			</div>
				  			<div class="form-group">
				    			<label for="password" class="col-sm-2 control-label">Answer</label>
				    			<div class="col-sm-10">
				      				<input type="text" class="form-control" id="add_answer" placeholder="Answer">
				    			</div>
				  			</div>
						</form>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">cancel</button>
					<button id="submit_add_question" type="submit" class="btn btn-default">submit</button>
				</div>
			</div>
		</div>
	</div> 
	<div class="modal fade" id="modal_edit_question" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Edit Question</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
				</div>
				<div class="modal-body">
					<div class="login_box">
						<form class="form-horizontal">
							<input type="hidden" class="form-control" id="question_id">
					  		<div class="form-group">
					    		<label for="username" class="col-sm-2 control-label">Question</label>
					    		<div class="col-sm-10">
					    			<textarea class="form-control" id="edit_question" placeholder="Question"></textarea>
				    			</div>
				  			</div>
				  			<div class="form-group">
				    			<label for="password" class="col-sm-2 control-label">Answer</label>
				    			<div class="col-sm-10">
				      				<input type="text" class="form-control" id="edit_answer" placeholder="Answer">
				    			</div>
				  			</div>
						</form>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">cancel</button>
					<button id="submit_edit_question" type="submit" class="btn btn-default">submit</button>
				</div>
			</div>
		</div>
	</div> 
</body>
</html>
<script type="text/javascript">
	$(document).ready(function(){
		$.ajax({
			url: '/question_list',
			type: 'GET',
			dataType: 'json',
			data: {},
			success: function(data, textStatus, xhr) {
				if(data.status == 'success'){
					var question_list ="";
					for(var i =0; i<data.list.length; i++){
						question_list += '<li class="li_question">' +
							'<div>' +data.list[i].question+'</div>' +
							'<span class="li_left">'+ data.list[i].answer+'</span>' +
							'<span class="li_right">'+
							'<button class="btn btn-default" onclick="getQuestion('+data.list[i].question_id+')">Edit</button>'+
							'<button class="btn btn-default" onclick="deleteQuestion('+data.list[i].question_id+')">Delete</button>'+
							'</span>'+
						'</li>';
					}
					$("#ul_question").html(question_list);
				}
			},
			error: function(xhr, textStatus, errorThrown) {
			//called when there is an error
			}	
		});
		function getQuestion(id){
			$.ajax({
				url: '/question_get',
				type: 'GET',
				dataType: 'json',
				data: {'id': id},
				success: function(data, textStatus, xhr) {
					if(data.status == 'success'){
						$("#question_id").val(data.id);
						$("#edit_question").val(data.question);
						$("#edit_answer").val(data.answer);
						$("#modal_edit_question").modal("show");
					}
				},
				error: function(xhr, textStatus, errorThrown) {
				//called when there is an error
				}	
			});
		}
		function deleteQuestion(id){
			if(confirm("do you want to delete?") == false){
				return;
			}
			$.ajax({
				url: '/question_delete',
				type: 'GET',
				dataType: 'json',
				data: {'id': id},
				success: function(data, textStatus, xhr) {
					if(data.status == 'success'){
						window.location.href = window.location.href;
						alert("delete success");
					}
				},
				error: function(xhr, textStatus, errorThrown) {
				//called when there is an error
				}	
			});
		}
		$("#submit_add_question").click(function(){
			event.preventDefault();
			var question = $("#add_question").val().trim();
			var answer = $("#add_answer").val().trim();
			if(question.length == 0 ){
				alert("Please input question");
				return;
			}
			if(answer.length == 0 ){
				alert("Please input answer");
				return;
			}
			$.ajax({
				url: '/question_add',
				type: 'POST',
				dataType: 'json',
				data: {'question': question, 'answer': answer},
				success: function(data, textStatus, xhr) {
					if(data.status == 'success'){
						window.location.href = window.location.href;
						alert("add success");
					}else{
						alert("try again");
					}
				},
				error: function(xhr, textStatus, errorThrown) {
				//called when there is an error
				}	
			});
		});
		$("#submit_edit_question").click(function(){
			event.preventDefault();
			var id = $("#question_id").val();
			var question = $("#edit_question").val().trim();
			var answer = $("#edit_answer").val().trim();
			if(question.length == 0 ){
				alert("Please input question");
				return;
			}
			if(answer.length == 0 ){
				alert("Please input answer");
				return;
			}
			$.ajax({
				url: '/question_edit',
				type: 'POST',
				dataType: 'json',
				data: {'id':id,'question': question, 'answer': answer},
				success: function(data, textStatus, xhr) {
					if(data.status == 'success'){
						window.location.href = window.location.href;
						alert("edit success");
					}else{
						alert("try again");
					}
				},
				error: function(xhr, textStatus, errorThrown) {
				//called when there is an error
				}	
			});
		});
		$("#submit_search").click(function(){
			event.preventDefault();
			var content = $("#search_content").val().trim();
			if(content.length == 0 ){
				return;
			}
			$.ajax({
			url: '/question_list',
			type: 'GET',
			dataType: 'json',
			data: {'content': content},
			success: function(data, textStatus, xhr) {
				if(data.status == 'success'){
					var question_list ="";
					for(var i =0; i<data.list.length; i++){
						question_list += '<li class="li_question">' +
							'<div>' +data.list[i].question+'</div>' +
							'<span class="li_left">'+ data.list[i].answer+'</span>' +
							'<span class="li_right">'+
							'<button class="btn btn-default" onclick="getQuestion('+data.list[i].question_id+')">Edit</button>'+
							'<button class="btn btn-default" onclick="deleteQuestion('+data.list[i].question_id+')">Delete</button>'+
							'</span>'+
						'</li>';
					}
					$("#ul_question").html(question_list);
				}
			},
			error: function(xhr, textStatus, errorThrown) {
			//called when there is an error
			}	
		});

	});
</script>